<div class="min-h-screen">
  <!-- Skeleton Loader -->
  <div *ngIf="isLoading" class="mx-auto pt-8 md:px-10 big:px-[280px]">
    <!-- Header Skeleton -->
    <div class="mb-6">
      <div class="h-8 w-40 bg-gray-200 rounded-md animate-pulse mb-2"></div>
      <div class="h-8 w-72 bg-gray-200 rounded-md animate-pulse"></div>
    </div>

    <!-- Buttons Skeleton -->
    <div class="flex gap-4 mb-10">
      <div
        class="h-14 max-w-[284.5px] w-full bg-gray-200 rounded-[99px] animate-pulse"
      ></div>
      <div
        class="h-14 max-w-[284.5px] w-full bg-gray-200 rounded-[99px] animate-pulse"
      ></div>
    </div>

    <!-- Agents Header Skeleton -->
    <div class="mb-6">
      <div class="h-7 w-32 bg-gray-200 rounded-md animate-pulse"></div>
    </div>

    <!-- Agents Cards Skeleton -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-[32px]">
      <!-- Repeat this skeleton card 4 times -->
      <div
        *ngFor="let i of [1, 2, 3, 4]"
        class="rounded-md py-4 bg-white max-w-[272px]"
      >
        <div class="flex justify-between gap-5 mb-2">
          <div
            class="bg-gray-200 h-[44px] rounded-md mb-3 w-[44px] animate-pulse"
          ></div>
          <div class="flex-1">
            <div
              class="h-5 bg-gray-200 rounded-md animate-pulse mb-3 w-3/4"
            ></div>
            <div
              class="h-4 bg-gray-200 rounded-md animate-pulse mb-3 w-full"
            ></div>
            <div
              class="h-4 bg-gray-200 rounded-md animate-pulse mb-3 w-5/6"
            ></div>

            <div class="flex gap-5 items-center">
              <div class="flex items-center gap-2">
                <div class="w-6 h-6 bg-gray-200 rounded-md animate-pulse"></div>
                <div
                  class="h-4 w-16 bg-gray-200 rounded-md animate-pulse"
                ></div>
              </div>
              <div class="flex items-center gap-1">
                <div class="w-4 h-4 bg-gray-200 rounded-md animate-pulse"></div>
                <div class="h-4 w-6 bg-gray-200 rounded-md animate-pulse"></div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Actual Content - Only show when not loading -->
  <div
    *ngIf="!isLoading && !showDocumentUploadStepper"
    class="mx-auto pt-8 md:px-10 big:px-[280px]"
  >
    <!-- Existing code for the top section -->
    <div class="mb-6">
      <h1 class="text-2xl font-bold text-black">Meet Evo,</h1>
      <p class="text-[#667085] text-2xl">How can i help you today?</p>
    </div>

    <div class="flex gap-4 mb-10">
      <button
        (click)="openRapidResponseDialog()"
        class="flex items-center gap-2 border rounded-[99px] max-w-[284.5px] w-full p-4 hover:bg-gray-50 transition-colors"
      >
        <img src="/images/Frame.svg" alt="icon" class="w-5" />
        <span>Rapid Response</span>
      </button>

      <button
        class="flex items-center gap-2 border rounded-[99px] max-w-[284.5px] w-full p-4 hover:bg-gray-50 transition-colors"
      >
        <img src="/images/analyze doc.svg" alt="icon" class="w-5" />

        <span>Analyze a Document</span>
      </button>
    </div>

    <!-- Rest of existing code -->
    <div class="mb-10">
      <h2 class="text-[20px] text-black font-medium mb-6">AI Agents</h2>

      <div class="grid grid-cols-1 md:grid-cols-2 gap-[32px]">
        <div
          *ngFor="let agent of agents"
          class="rounded-md py-4 bg-white max-w-[272px]"
        >
          <div class="flex justify-between gap-5 mb-2">
            <div
              class="bg-[#F2F4F7] h-[44px] rounded-md mb-3 w-[44px] flex justify-center items-center p-3"
            >
              <i class="pi pi-file"></i>
            </div>

            <div>
              <h3 class="font-medium">{{ agent.type }}</h3>
              <p class="text-sm text-gray-600 mt-1 mb-3">
                {{ agent.description }}
              </p>

              <div class="flex gap-5 items-center">
                <div class="flex items-center gap-2">
                  <span
                    [class]="
                      'w-6 h-6 bg-[#F2F4F7] rounded-md flex items-center justify-center text-xs  font-medium '
                    "
                  >
                    {{ agent.manager.initial }}
                  </span>
                  <span class="text-sm text-gray-600">{{
                    agent.manager.name
                  }}</span>
                </div>

                <div class="flex items-center gap-1 text-gray-600">
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="16"
                    height="16"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  >
                    <path
                      d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"
                    ></path>
                  </svg>
                  <span class="text-sm">{{ agent.commentCount }}</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Stepper Skeleton -->
  <div
    *ngIf="isLoading && showDocumentUploadStepper"
    class="w-full h-screen flex justify-center items-center"
  >
    <div class="mt-8 p-6 bg-white rounded-lg max-w-[744px] w-full">
      <!-- Stepper Header Skeleton -->
      <div class="flex flex-col mb-5">
        <div class="flex items-start">
          <div class="w-8 h-8 bg-gray-200 rounded-full animate-pulse"></div>
          <div class="ml-2">
            <div
              class="h-8 w-64 bg-gray-200 rounded-md animate-pulse mb-2"
            ></div>
            <div class="h-4 w-72 bg-gray-200 rounded-md animate-pulse"></div>
          </div>
        </div>
      </div>

      <!-- File Upload Area Skeleton -->
      <div class="mb-6 px-10">
        <div
          class="border border-[#E9EAEB] bg-[#F9FAFB] rounded-lg py-12 px-6 flex flex-col items-center justify-center"
        >
          <div
            class="w-10 h-10 bg-gray-200 rounded-md animate-pulse mb-3"
          ></div>
          <div class="h-5 w-32 bg-gray-200 rounded-md animate-pulse"></div>
        </div>

        <!-- Button Area Skeleton -->
        <div class="flex justify-between mt-5">
          <div class="w-8 h-8 bg-gray-200 rounded-md animate-pulse"></div>
          <div class="flex items-center gap-4">
            <div class="h-10 w-24 bg-gray-200 rounded-xl animate-pulse"></div>
            <div class="h-6 w-24 bg-gray-200 rounded-md animate-pulse"></div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Actual stepper -->
  <div
    *ngIf="!isLoading && showDocumentUploadStepper"
    class="w-full h-screen flex justify-center items-center"
  >
    <div class="mt-8 p-6 bg-white rounded-lg max-w-[744px] w-full">
      <!-- Step 1: Document Upload -->
      <div *ngIf="currentStep === 1">
        <div class="flex flex-col mb-5">
          <div class="flex items-start">
            <div
              class="text-2xl flex items-center gap-1 justify-center text-black font-medium"
            >
              1
              <i class="pi pi-arrow-right text-[#792EBA]"> </i>
            </div>
            <div class="ml-2 text-black text-2xl font-medium mb-2">
              What document you want to analyze?
              <p class="text-sm text-[#667085] font-sans">
                Select a file (PDF, Word, etc.) to import.
              </p>
            </div>
          </div>
        </div>

        <div class="mb-6 px-10">
          <!-- File upload area content remains unchanged -->
          <div
            class="border border-[#E9EAEB] bg-[#F9FAFB] rounded-lg py-4 px-6 text-center flex flex-col items-center justify-center"
            [class.border-[#792EBA]]="isDragging"
            [class.bg-[#F9F7FC]]="isDragging"
            (dragover)="onDragOver($event)"
            (dragleave)="onDragLeave($event)"
            (drop)="onDrop($event)"
          >
            <!-- Hidden file input -->
            <input
              type="file"
              #fileInput
              (change)="onFileSelected($event)"
              style="display: none"
              accept="image/jpeg, image/png, image/gif, application/pdf, application/msword, application/vnd.openxmlformats-officedocument.wordprocessingml.document, text/plain"
            />

            <!-- If no file is selected or uploading -->
            <div
              *ngIf="!selectedFile && !isUploading"
              class="flex flex-col items-center"
            >
              <div
                class="bg-white p-2.5 border border-[#E9EAEB] rounded-md w-10 h-10 shadow-md mb-3"
              >
                <i class="pi pi-cloud-upload"></i>
              </div>
              <div class="flex items-center gap-1">
                <p
                  class="text-sm text-[#792EBA] font-medium cursor-pointer hover:underline"
                  (click)="fileInput.click()"
                >
                  Click to upload
                </p>
                <p class="text-xs text-[#535862]">or drag-and-drop</p>
              </div>
            </div>

            <!-- Progress indicator section - Replace the progress bar with a spinner -->
            <div
              *ngIf="isUploading"
              class="w-full flex justify-between items-center"
            >
              <div class="flex items-center justify-between gap-2 py-2">
                <div class="flex items-start gap-3">
                  <div class="rounded-md">
                    <i class="pi pi-file"></i>
                  </div>
                  <div class="text-left">
                    <p
                      class="text-sm font-medium text-[#414651] truncate max-w-[300px]"
                    >
                      {{ selectedFile?.name }}
                    </p>
                    <p class="text-xs text-[#667085]">
                      {{
                        selectedFile ? (selectedFile.size / 1024).toFixed(0) : 0
                      }}
                      KB
                      <span class="ml-1">{{ uploadProgress }}% uploaded</span>
                    </p>
                  </div>
                </div>
              </div>

              <!-- Spinner instead of progress bar -->
              <div class="flex justify-center my-2">
                <div
                  class="w-8 h-8 rounded-full border-4 border-[#E9EAEB] border-t-[#792EBA] animate-spin"
                ></div>
              </div>
            </div>

            <!-- If file is selected and upload completed -->
            <div *ngIf="selectedFile && !isUploading" class="w-full">
              <div class="flex items-center justify-between rounded-md">
                <div class="flex items-start gap-3">
                  <div class="rounded-md">
                    <i class="pi pi-file"></i>
                  </div>
                  <div class="text-left">
                    <p
                      class="text-sm font-medium text-[#414651] truncate max-w-[300px]"
                    >
                      {{ selectedFile.name }}
                    </p>
                    <p class="text-xs text-[#667085]">
                      {{ (selectedFile.size / 1024).toFixed(0) }} KB - 100%
                      uploaded
                    </p>
                  </div>
                </div>
                <button
                  class="text-[#667085] bg-white p-2.5 rounded-xl w-10 h-10 flex justify-center items-center border border-[#DEE0E3] hover:text-red-500 transition-colors"
                  (click)="removeFile()"
                >
                  <i class="pi pi-trash"></i>
                </button>
              </div>
            </div>
          </div>

          <div *ngIf="errorMessage" class="text-red-500 text-sm mt-2">
            {{ errorMessage }}
          </div>

          <div class="flex justify-between mt-5">
            <button (click)="goToPreviousStep()">
              <i class="pi pi-arrow-left text-[#0F132499]/60"></i>
            </button>

            <div class="flex items-center gap-4">
              <button
                class="px-4 py-3 bg-[#9241DC] text-white rounded-xl hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed"
                [disabled]="!selectedFile || isUploading"
                (click)="continueToNextStep()"
              >
                Continue
              </button>

              <button
                class="flex gap-2 items-start text-[#0F132499]/60 cursor-default"
              >
                <img src="images/curved-arrow.png" class="w-5 h-5" alt="" />
                press enter
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Step 2: Ask Question -->
      <div *ngIf="currentStep === 2 && !isAnalyzing">
        <div class="flex flex-col mb-5">
          <div class="flex items-start">
            <div
              class="text-2xl flex items-center gap-1 justify-center text-black font-medium"
            >
              2
              <i class="pi pi-arrow-right text-[#792EBA]"> </i>
            </div>
            <h1 class="ml-2 text-black text-2xl font-medium mb-2">
              What is your ask?
            </h1>
          </div>
        </div>

        <div class="mb-6 px-10">
          <!-- Question input -->
          <div class="mb-4">
            <input
              type="text"
              [(ngModel)]="userQuestion"
              placeholder="What do you want to ask about this document?"
              class="w-full py-2.5 px-3 border border-[#DEE0E3] rounded-xl placeholder:text-[#0D112666]/40 text-black font-bold focus:outline-none focus:ring-2 focus:ring-[#792EBA] focus:border-transparent"
              (keydown)="onQuestionInputKeypress($event)"
            />
          </div>

          <div class="flex justify-between mt-5">
            <button (click)="goToPreviousStep()">
              <i class="pi pi-arrow-left text-[#0F132499]/60"></i>
            </button>

            <div class="flex items-center gap-4">
              <button
                class="px-4 py-3 bg-[#9241DC] text-white rounded-xl hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed"
                [disabled]="!userQuestion.trim()"
                (click)="continueToNextStep()"
              >
                Continue
              </button>

              <button
                class="flex gap-2 items-start text-[#0F132499]/60 cursor-default"
              >
                <img src="images/curved-arrow.png" class="w-5 h-5" alt="" />
                press enter
              </button>
            </div>
          </div>
        </div>
      </div>

      <!-- Step 3: Results (placeholder for future implementation) -->
      <div
        *ngIf="isAnalyzing"
        class="w-full h-screen flex flex-col justify-center items-center"
      >
        <div class="relative mb-8">
          <div class="w-20 h-20 rounded-full bg-purple-200 opacity-50"></div>
          <div
            class="absolute top-1/2 left-1/2 transform -translate-x-1/2 -translate-y-1/2"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="none"
              stroke="#9241DC"
              stroke-width="2"
              stroke-linecap="round"
              stroke-linejoin="round"
            >
              <path
                d="M12 2v4M12 18v4M4.93 4.93l2.83 2.83M16.24 16.24l2.83 2.83M2 12h4M18 12h4M4.93 19.07l2.83-2.83M16.24 7.76l2.83-2.83"
              ></path>
            </svg>
          </div>
        </div>

        <!-- Status text -->
        <div class="text-center">
          <h3
            [ngClass]="{
              'text-gray-400': analysisComplete,
              'text-black font-medium': !analysisComplete
            }"
            class="text-xl mb-2"
          >
            Analyzing the document
          </h3>
          <p
            [ngClass]="{
              'text-black font-medium': analysisComplete,
              'text-gray-400': !analysisComplete
            }"
            class="text-lg"
          >
            Bringing our top consultants...
          </p>
        </div>
      </div>

      <!-- Modified Step 3 for the consultant suggestions -->
      <div *ngIf="currentStep === 3">
        <div class="flex flex-col mb-5">
          <div class="flex items-start">
            <div
              class="text-2xl flex items-center gap-1 justify-center text-black font-medium"
            >
              3
              <i class="pi pi-arrow-right text-[#792EBA]"> </i>
            </div>
            <div class="ml-2 text-black text-2xl font-medium mb-2">
              Based on your Ask, I am suggesting the following consultants
              <p class="text-sm text-[#667085] font-sans">
                Select AI consultant suggestions (0/3)
              </p>
            </div>
          </div>
        </div>

        <div class="mb-6 px-10">
          <!-- Consultant cards -->
          <div class="space-y-4">
            <!-- Customer Support Consultant Card -->
            <div class="bg-white rounded-lg p-4">
              <div class="flex items-start">
                <div class="bg-gray-100 rounded-xl p-3 mr-4">
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="16"
                    height="16"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  >
                    <path
                      d="M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"
                    ></path>
                  </svg>
                </div>
                <div class="flex-1">
                  <h3 class="font-medium">Customer Support Consultant</h3>
                  <p class="text-sm text-gray-600 mt-1">
                    Designed to resolve sensitive issues efficiently while
                    ensuring a positive customer experience
                  </p>

                  <div class="flex gap-5 items-center mt-3">
                    <div class="flex items-center gap-2">
                      <span
                        class="w-6 h-6 bg-[#F2F4F7] rounded-md flex items-center justify-center text-xs font-medium"
                      >
                        S
                      </span>
                      <span class="text-sm text-gray-600">Sayed E.</span>
                    </div>

                    <div class="flex items-center gap-1 text-gray-600">
                      <svg
                        xmlns="http://www.w3.org/2000/svg"
                        width="16"
                        height="16"
                        viewBox="0 0 24 24"
                        fill="none"
                        stroke="currentColor"
                        stroke-width="2"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                      >
                        <path
                          d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"
                        ></path>
                      </svg>
                      <span class="text-sm">1</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Marketing Consultant Card -->
            <div class="bg-white rounded-lg p-4">
              <div class="flex items-start">
                <div class="bg-gray-100 rounded-xl p-3 mr-4">
                  <svg
                    xmlns="http://www.w3.org/2000/svg"
                    width="16"
                    height="16"
                    viewBox="0 0 24 24"
                    fill="none"
                    stroke="currentColor"
                    stroke-width="2"
                    stroke-linecap="round"
                    stroke-linejoin="round"
                  >
                    <path
                      d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"
                    ></path>
                  </svg>
                </div>
                <div class="flex-1">
                  <h3 class="font-medium">Marketing Consultant</h3>
                  <p class="text-sm text-gray-600 mt-1">
                    Designed to resolve sensitive issues efficiently while
                    ensuring a positive customer experience
                  </p>

                  <div class="flex gap-5 items-center mt-3">
                    <div class="flex items-center gap-2">
                      <span
                        class="w-6 h-6 bg-[#F2F4F7] rounded-md flex items-center justify-center text-xs font-medium"
                      >
                        S
                      </span>
                      <span class="text-sm text-gray-600">Sayed E.</span>
                    </div>

                    <div class="flex items-center gap-1 text-gray-600">
                      <svg
                        xmlns="http://www.w3.org/2000/svg"
                        width="16"
                        height="16"
                        viewBox="0 0 24 24"
                        fill="none"
                        stroke="currentColor"
                        stroke-width="2"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                      >
                        <path
                          d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"
                        ></path>
                      </svg>
                      <span class="text-sm">1</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Navigation controls -->
          <div class="flex justify-between mt-8">
            <button (click)="goToPreviousStep()">
              <i class="pi pi-arrow-left text-[#0F132499]/60"></i>
            </button>

            <div class="flex items-center gap-4">
              <button
                (click)="continueToNextStep()"
                class="px-6 py-3 bg-[#9241DC] text-white rounded-xl hover:bg-purple-700"
              >
                Continue
              </button>

              <button
                class="flex gap-2 items-start text-[#0F132499]/60 cursor-default"
              >
                <img src="images/curved-arrow.png" class="w-5 h-5" alt="" />
                press enter
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
