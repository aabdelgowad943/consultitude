<div class="flex flex-col">
  <!-- Small Screen Layout -->
  <div
    class="sticky top-0 w-full bg-[#F9FAFB] z-50 py-2 flex flex-col md:hidden"
  >
    <div class="flex items-center justify-between w-full gap-2">
      <span class="text-gray-600 text-sm"
        >{{ filteredTemplates.length }} results shown</span
      >
      <div class="flex items-center gap-2">
        <button
          class="sm:hidden flex items-center px-4 py-2 text-gray-600 bg-white border rounded-xl shadow-sm"
          (click)="openSidebare()"
        >
          <i class="pi pi-filter"></i>
          <span class="ml-2 text-[14px]">Filters</span>
        </button>
        <div class="relative right-0 inline-block text-left">
          <button
            (click)="toggleSortMenu()"
            class="flex items-center px-4 py-2 text-gray-700 border border-gray-300 rounded-xl shadow-sm hover:bg-gray-100 transition"
          >
            <i class="pi pi-sort-alt text-[#0F132499]/60"></i>
            <span class="mx-2 text-[#14151A] text-[14px]">Sort by</span>
            <i class="pi pi-chevron-down text-[#0F132499]/60"></i>
          </button>
          <div
            *ngIf="isSortMenuOpen"
            class="absolute right-0 mt-2 w-56 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 z-10"
          >
            <div class="py-1">
              <button
                *ngFor="let option of sortOptions"
                (click)="selectSortOption(option.value)"
                class="block px-4 py-2 text-sm w-full text-left"
                [ngClass]="{
                  'bg-[#F9F5FF] text-[#7F56D9]':
                    currentSortOption === option.value,
                  'text-gray-700 hover:bg-gray-100':
                    currentSortOption !== option.value
                }"
              >
                {{ option.label }}
              </button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Selected Filters -->
    <div class="flex flex-nowrap gap-2 overflow-x-auto w-full mt-2">
      <div
        *ngFor="let filter of selectedFilters"
        class="flex items-center justify-center bg-[#FFFFFF] rounded-full border border-[#D0D5DD] text-[#0F132499]/60 px-3 py-2"
      >
        <span>{{ filter.label }}</span>
        <button (click)="removeFilter.emit(filter)" class="ml-2 text-gray-400">
          x
        </button>
      </div>
    </div>
  </div>

  <!-- Large Screen Layout -->
  <div
    class="hidden md:flex sticky top-0 w-full bg-[#F9FAFB] z-50 py-2 justify-between items-center"
  >
    <!-- Selected Filters -->
    <div class="flex flex-nowrap max-w-[80%] h-full gap-2 overflow-x-auto">
      <div
        *ngFor="let filter of selectedFilters"
        class="flex items-center justify-center bg-[#FFFFFF] rounded-full border border-[#D0D5DD] text-[#0F132499]/60 px-3 py-2"
      >
        <span>{{ filter.label }}</span>
        <button (click)="removeFilter.emit(filter)" class="ml-2 text-gray-400">
          x
        </button>
      </div>
    </div>

    <!-- Sort Menu Button -->
    <div class="flex items-center justify-end gap-2">
      <button
        class="sm:hidden flex items-center px-4 py-2 text-gray-600 bg-white border rounded-lg shadow-sm"
        (click)="openSidebare()"
      >
        <i class="pi pi-filter"></i>
        <span class="ml-2">Filters</span>
      </button>
      <div class="relative right-0 inline-block text-left">
        <button
          (click)="toggleSortMenu()"
          class="flex items-center px-4 py-2 text-gray-700 border border-gray-300 rounded-xl shadow-sm hover:bg-gray-100 transition"
        >
          <i class="pi pi-sort-alt text-[#0F132499]/60"></i>
          <span class="mx-2 text-[#14151A]">Sort by</span>
          <i class="pi pi-chevron-down text-[#0F132499]/60"></i>
        </button>
        <div
          *ngIf="isSortMenuOpen"
          class="absolute right-0 mt-2 w-56 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5 z-10"
        >
          <div class="py-1">
            <button
              *ngFor="let option of sortOptions"
              (click)="selectSortOption(option.value)"
              class="block px-4 py-2 text-sm w-full text-left"
              [ngClass]="{
                'bg-[#F9F5FF] text-[#7F56D9]':
                  currentSortOption === option.value,
                'text-gray-700 hover:bg-gray-100':
                  currentSortOption !== option.value
              }"
            >
              {{ option.label }}
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Templates Grid -->
  <section
    *ngIf="filteredTemplates && filteredTemplates.length > 0"
    class="grid grid-cols-1 sm:grid-cols-2 gap-4 mt-4"
  >
    <app-product-card
      *ngFor="let template of filteredTemplates"
      [template]="template"
      (tagClick)="tagClick.emit($event)"
    >
    </app-product-card>
  </section>

  <!-- No Results Section -->
  <div
    *ngIf="dataLoaded && (!filteredTemplates || filteredTemplates.length === 0)"
    class="flex flex-col items-center justify-center mt-[24px] min-h-[400px] bg-white rounded-2xl border border-[#EAECF0] text-center py-12 px-4"
  >
    <div class="max-w-md mx-auto space-y-6">
      <img src="/images/no items.svg" class="mx-auto" alt="" />
      <div class="space-y-2">
        <h3
          class="md:text-[32px] text-[20px] font-[500] md:leading-[38.4px] text-[#111827]"
        >
          We couldn't find documents <br class="md:block hidden" />matching
          <br class="md:hidden block" />
          your search.
        </h3>
      </div>
      <div class="flex flex-col items-center sm:flex-row gap-4 justify-center">
        <button
          (click)="clearFilters.emit()"
          class="px-4 py-2.5 text-[16px] md:w-[181px] w-[209px] h-[44px] font-sans bg-[#7F56D9] hover:bg-[#a24af5] text-white rounded-lg font-semibold transition-colors"
        >
          Refine your search
        </button>
        <button
          (click)="navigateToRequestDocument()"
          class="px-4 py-2 text-[16px] flex items-center md:w-[209px] w-[209px] h-[44px] gap-2 font-sans border border-[#D0D5DD] text-[#0D1F40] hover:bg-gray-50 rounded-lg font-medium transition-colors"
        >
          Request document <i class="pi pi-arrow-right"></i>
        </button>
      </div>
    </div>
  </div>
</div>

<!-- loader---------- -->

<!-- Skeleton loader for Knowledge Lounge -->
<div class="bg-[#F9FAFB] w-full" *ngIf="!dataLoaded">
  <div class="max-w-[1600px] mx-auto">
    <!-- Hero section skeleton -->
    <div class="w-full h-[300px] bg-gray-200 animate-pulse"></div>

    <div
      class="grid grid-cols-1 gap-6 lg:gap-10 md:grid-cols-12 py-10 px-4 sm:px-6 md:px-10 lg:px-20"
    >
      <!-- Sidebar skeleton -->
      <div class="md:col-span-3 col-span-12">
        <div class="bg-white rounded-lg p-4 shadow-sm">
          <!-- Search bar skeleton -->
          <div class="mb-6">
            <div class="w-32 h-5 bg-gray-200 rounded animate-pulse mb-2"></div>
            <div class="w-full h-10 bg-gray-200 rounded-xl animate-pulse"></div>
          </div>

          <!-- Filter sections skeleton -->
          <div class="space-y-6">
            <!-- Section 1 -->
            <div>
              <div
                class="w-24 h-5 bg-gray-200 rounded animate-pulse mb-3"
              ></div>
              <div class="space-y-2">
                <div class="flex items-center">
                  <div class="w-4 h-4 bg-gray-200 rounded animate-pulse"></div>
                  <div
                    class="w-20 h-4 bg-gray-200 rounded animate-pulse ml-2"
                  ></div>
                </div>
                <div class="flex items-center">
                  <div class="w-4 h-4 bg-gray-200 rounded animate-pulse"></div>
                  <div
                    class="w-24 h-4 bg-gray-200 rounded animate-pulse ml-2"
                  ></div>
                </div>
                <div class="flex items-center">
                  <div class="w-4 h-4 bg-gray-200 rounded animate-pulse"></div>
                  <div
                    class="w-16 h-4 bg-gray-200 rounded animate-pulse ml-2"
                  ></div>
                </div>
              </div>
            </div>

            <!-- Section 2 -->
            <div>
              <div
                class="w-32 h-5 bg-gray-200 rounded animate-pulse mb-3"
              ></div>
              <div class="space-y-2">
                <div class="flex items-center">
                  <div class="w-4 h-4 bg-gray-200 rounded animate-pulse"></div>
                  <div
                    class="w-28 h-4 bg-gray-200 rounded animate-pulse ml-2"
                  ></div>
                </div>
                <div class="flex items-center">
                  <div class="w-4 h-4 bg-gray-200 rounded animate-pulse"></div>
                  <div
                    class="w-20 h-4 bg-gray-200 rounded animate-pulse ml-2"
                  ></div>
                </div>
              </div>
            </div>

            <!-- Section 3 (Price range) -->
            <div>
              <div
                class="w-16 h-5 bg-gray-200 rounded animate-pulse mb-3"
              ></div>
              <div
                class="w-full h-2 bg-gray-200 rounded animate-pulse mb-4"
              ></div>
              <div class="flex justify-between">
                <div class="w-8 h-4 bg-gray-200 rounded animate-pulse"></div>
                <div
                  class="w-12 h-6 bg-gray-200 rounded-full animate-pulse"
                ></div>
                <div class="w-8 h-4 bg-gray-200 rounded animate-pulse"></div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Main Content skeleton -->
      <div class="col-span-12 md:col-span-9 md:w-full 2xl:w-[959px]">
        <!-- Header with sort and filter controls -->
        <div class="flex justify-between items-center mb-6">
          <div class="flex items-center">
            <div class="w-32 h-6 bg-gray-200 rounded animate-pulse"></div>
          </div>
          <div class="flex items-center gap-2">
            <div class="w-24 h-10 bg-gray-200 rounded animate-pulse"></div>
            <div
              class="w-10 h-10 bg-gray-200 rounded animate-pulse md:hidden"
            ></div>
          </div>
        </div>

        <!-- Applied filters skeleton -->
        <div class="flex flex-wrap gap-2 mb-6">
          <div class="w-20 h-8 bg-gray-200 rounded-full animate-pulse"></div>
          <div class="w-24 h-8 bg-gray-200 rounded-full animate-pulse"></div>
          <div class="w-16 h-8 bg-gray-200 rounded-full animate-pulse"></div>
        </div>

        <!-- Grid of template cards -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
          <!-- Template card skeletons -->
          <div
            class="bg-white rounded-xl border border-gray-200 overflow-hidden"
            *ngFor="let i of [1, 2, 3, 4, 5, 6]"
          >
            <!-- Card image skeleton -->
            <div class="w-full h-[200px] bg-gray-200 animate-pulse"></div>

            <!-- Card content skeleton -->
            <div class="p-4">
              <div class="flex justify-between items-center mb-2">
                <div class="w-24 h-6 bg-gray-200 rounded animate-pulse"></div>
                <div class="w-16 h-6 bg-gray-200 rounded animate-pulse"></div>
              </div>

              <div
                class="w-full h-4 bg-gray-200 rounded animate-pulse mb-2"
              ></div>
              <div
                class="w-3/4 h-4 bg-gray-200 rounded animate-pulse mb-4"
              ></div>

              <!-- Tags skeleton -->
              <div class="flex flex-wrap gap-2 mb-4">
                <div
                  class="w-16 h-6 bg-gray-200 rounded-lg animate-pulse"
                ></div>
                <div
                  class="w-20 h-6 bg-gray-200 rounded-lg animate-pulse"
                ></div>
              </div>

              <!-- Button skeleton -->
              <div
                class="w-full h-10 bg-gray-200 rounded-xl animate-pulse"
              ></div>
            </div>
          </div>
        </div>

        <!-- Pagination skeleton -->
        <div class="flex justify-center mt-6">
          <div class="w-full h-10 bg-gray-200 rounded animate-pulse"></div>
        </div>
      </div>
    </div>
  </div>
</div>
