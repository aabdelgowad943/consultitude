<!-- browse-agents.component.html -->
<div class="container mx-auto px-2 md:px-6 py-6">
  <!-- Header -->
  <div class="flex justify-between items-center mb-2">
    <div>
      <h1 class="text-[32px] font-bold text-[#14151A]">Browse Consultants</h1>
      <p class="text-[#0F132499] text-[16px] font-sans">
        Discover and create custom assistants that combine instructions, extra
        knowledge, and any combination of tasks.
      </p>
    </div>
    <button
      (click)="openDialog()"
      class="bg-[#9241DC] hover:bg-[#7735b5] text-[14px] transition-colors text-white rounded-xl px-3 py-2.5 flex items-center gap-2 w-[97px] max-h-[40px] justify-center"
    >
      <i class="pi pi-plus text-[14px]"></i>
      Create
    </button>
  </div>

  <!-- Filtering Tabs -->
  <div class="flex items-center mt-6 mb-6 gap-4">
    <div class="flex items-center bg-[#F2F4F7] rounded-xl p-0.5">
      <button
        (click)="filterAgents('all')"
        [class.active-tab]="activeFilter === 'all'"
        class="px-4 py-2 rounded-md text-sm transition-colors"
      >
        All
      </button>
      <button
        (click)="filterAgents('byme')"
        [class.active-tab]="activeFilter === 'byme'"
        class="px-4 py-2 rounded-md text-sm transition-colors"
      >
        By me
      </button>
      <button
        (click)="filterAgents('consultitude')"
        [class.active-tab]="activeFilter === 'consultitude'"
        class="px-4 py-2 rounded-md text-sm transition-colors"
      >
        Consultitude
      </button>
    </div>

    <!-- Search Input -->
    <div class="ml-auto relative flex-grow max-w-xs">
      <input
        type="text"
        placeholder="Search"
        [(ngModel)]="searchTerm"
        (input)="searchAgents()"
        class="w-full pl-8 pr-4 py-2 rounded-md border border-gray-300 text-sm focus:outline-none focus:ring-2 focus:ring-purple-500"
      />
      <i
        class="pi pi-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"
      ></i>
    </div>
  </div>

  <!-- Agents List -->
  <div
    class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-2 our:grid-cols-3 gap-4"
  >
    <div
      *ngFor="let agent of filteredAgents; let i = index"
      class="rounded-[20px] p-5 bg-white border border-[#EAECF0] max-w-[352px] relative group"
    >
      <div class="flex gap-5">
        <div
          class="bg-[#F2F4F7] h-[44px] rounded-md mb-3 w-[44px] flex justify-center items-center p-3"
        >
          <i class="pi pi-file text-[#9241DC]"></i>
        </div>

        <div class="w-full">
          <div class="flex w-full justify-between items-center">
            <h3 class="font-medium max-w-[207px]">{{ agent.name }}</h3>
            <div
              class="hidden group-hover:block"
              *ngIf="agent.profileId === profileId"
            >
              <button
                (click)="toggleDropdown(i, $event)"
                class="text-gray-500 bg-[#0A0F290A]/5 flex justify-between items-center hover:bg-gray-100 w-6 h-6 rounded-md p-[5px]"
              >
                <i class="pi pi-ellipsis-v text-sm"></i>
              </button>
            </div>
          </div>
          <p class="text-sm text-[#667085] mt-1 mb-3 line-clamp-2 max-w-[80%]">
            {{ agent.output }}
          </p>

          <div class="flex gap-5 items-center">
            <div
              class="w-6 h-6 bg-[#F2F4F7] rounded-md flex items-center justify-center text-xs text-[#9241DC] font-medium mr-2"
            >
              {{ agent.owner.charAt(0) }}
            </div>
            <div class="flex items-center text-gray-400">
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="h-4 w-4 mr-1"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="2"
                  d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"
                />
              </svg>
              <span class="text-xs">{{ agent.comments }}</span>
            </div>
          </div>
        </div>
      </div>

      <!-- Dropdown menu -->
      <div
        *ngIf="openDropdownIndex === i"
        class="absolute top-12 right-4 bg-white shadow-md rounded-md py-1 z-10 w-48 border agent-dropdown"
      >
        <button
          class="w-full text-left px-4 py-2 hover:bg-gray-100 text-sm text-black"
          (click)="editAgent(agent)"
        >
          Edit
        </button>
        <div
          class="flex items-center justify-between px-4 py-2 hover:bg-gray-100"
        >
          <span class="text-sm text-black">
            {{ agent.isActive ? "Deactivate" : "Activate" }}
          </span>
          <label class="relative inline-flex items-center cursor-pointer">
            <input
              id="{{ agent.id }}"
              type="checkbox"
              [checked]="agent.isActive"
              (change)="toggleActivation(agent, $event)"
              class="sr-only peer"
            />
            <div
              class="w-9 h-5 bg-gray-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-4 after:w-4 after:transition-all peer-checked:bg-blue-600"
            ></div>
          </label>
        </div>
      </div>
    </div>
  </div>

  <div *ngIf="totalRecords > 0" class="flex justify-center py-2">
    <p-paginator
      (onPageChange)="onPageChange($event)"
      [first]="first"
      [rows]="pageSize"
      [totalRecords]="totalRecords"
      class="w-full"
      styleClass="w-full"
    ></p-paginator>
  </div>
</div>

<!-- Modal components remain the same -->
<app-create-ai-consultant
  [(display)]="displayEditDialog"
  (displayChange)="onDisplayChange($event)"
  (onModalChange)="getAllAgents()"
></app-create-ai-consultant>

<app-edit-ai-consultant
  [(display)]="displayEditConsultantDialog"
  (displayChange)="onEditDisplayChange($event)"
  [agentData]="selectedAgent"
  (onModalChange)="getAllAgents()"
></app-edit-ai-consultant>
